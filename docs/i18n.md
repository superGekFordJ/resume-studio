# Internationalization (i18n)

This document outlines the internationalization (i18n) strategy and implementation for the Resume Studio (简历工坊) application.

## 1. Technology Stack

- **`react-i18next`** and **`i18next`**: The core libraries for handling translations in React components.
- **`i18next-browser-languagedetector`**: A plugin to automatically detect the user's language from the browser settings.

## 2. File Structure

All translation files are located in the `public/locales` directory, organized by language code. Each language has three separate JSON files for better organization:

```
public/
└── locales/
    ├── en/
    │   ├── common.json      # Common terms (e.g., Close, Add, Select)
    │   ├── components.json  # Strings specific to React components
    │   └── schemas.json     # Strings derived from data schemas (e.g., field labels, placeholders)
    └── zh/
        ├── common.json
        ├── components.json
        └── schemas.json
```

## 3. Configuration (`src/i18n.ts`)

The main i18n configuration is located in `src/i18n.ts`.

Key features of the configuration:
- **SSR Compatibility**: To avoid issues with Server-Side Rendering (SSR), translation resources are imported directly into the configuration file. This preloads the translations on the server and prevents any backend from trying to fetch them via HTTP, which would fail in a server environment.
- **Language Detection**: The `i18next-browser-languagedetector` is used to set the initial language for the user.
- **Namespaces**: Translations are split into three namespaces (`common`, `components`, `schemas`) to keep the files organized and manageable. `common` is the default namespace.

## 4. Usage in Components

### 4.1. Basic Translation

To use translations in a component, import the `useTranslation` hook from `react-i18next`.

```tsx
import { useTranslation } from 'react-i18next';

function MyComponent() {
  // Specify the namespace(s) you need.
  // If no namespace is provided, 'common' is used by default.
  const { t } = useTranslation('components');

  return <h1>{t('Header.resumeStudio')}</h1>;
}
```

### 4.2. Using Multiple Namespaces

If a component needs strings from multiple files (e.g., a specific component string and a common term), you can pass an array of namespaces.

```tsx
const { t } = useTranslation(['components', 'common']);

// ...

<Button>{t('dialog.close', { ns: 'common' })}</Button>
<p>{t('MyComponent.specificText', { ns: 'components' })}</p>
```

### 4.3. Translating Schema-Derived Content

When rendering content based on the data schemas (from `src/lib/schemas/defaultSchemas.ts`), all UI-facing strings like `label`, `placeholder`, and `name` are translation keys. These keys must be translated using the `schemas` namespace.

```tsx
import { useTranslation } from 'react-i18next';

function Field({ fieldSchema }) {
  const { t: tSchema } = useTranslation('schemas');

  return <label>{tSchema(fieldSchema.label)}</label>;
}
```

## 5. Adding a New Language

To add a new language (e.g., French `fr`):

1.  Create a new directory `public/locales/fr`.
2.  Copy the three JSON files (`common.json`, `components.json`, `schemas.json`) from `public/locales/en` into the new `fr` directory.
3.  Translate the values in all three JSON files into French.
4.  Import the new `fr` translation files into `src/i18n.ts` and add them to the `resources` object.
5.  Add the new language option to the language switcher in `src/components/layout/SettingsPanel.tsx`.

```typescript
// src/i18n.ts

// ... import fr files
import frCommon from '../public/locales/fr/common.json';
// ...

const resources = {
  en: { /* ... */ },
  zh: { /* ... */ },
  fr: {
    common: frCommon,
    // ...
  },
};
```
